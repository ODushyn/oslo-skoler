<!-- Search + Legend toolbar -->
<div class="map-toolbar">
    <div class="search-container">
        <div class="search-input-wrapper">
            <input type="text" id="schoolSearch" placeholder="SÃ¸k etter skole..." autocomplete="off">
            <button id="clearSearch" class="clear-search" title="TÃ¸m sÃ¸k">&times;</button>
        </div>
        <div id="searchResults" class="search-results"></div>
    </div>

    <!-- Legend Box -->
    <div id="legendBox" class="legend-box">

        <!-- Collapsed state: round i-button -->
        <button id="legendCollapsed"
                onclick="document.getElementById('legendCollapsed').style.display='none';
                         document.getElementById('legendExpanded').style.display='block';"
                title="Info"
                style="width:44px; height:44px; background-color:#4285f4; color:white;
                       border:2px solid #357ae8; border-radius:50%; font-size:22px; font-weight:bold;
                       cursor:pointer; display:flex; align-items:center; justify-content:center;
                       box-shadow:0 2px 10px rgba(0,0,0,0.3); transition:background-color 0.2s;">i</button>

        <!-- Expanded state: full panel -->
        <div id="legendExpanded"
             style="display:none; width:240px; background-color:white; border:2px solid grey;
                    font-size:14px; border-radius:5px; box-shadow:0 0 15px rgba(0,0,0,0.2);">
            <div style="padding:8px 10px; display:flex; align-items:center; justify-content:space-between;
                        font-weight:bold; border-bottom:1px solid #eee;">
                <span>Info</span>
                <span onclick="document.getElementById('legendExpanded').style.display='none';
                               document.getElementById('legendCollapsed').style.display='flex';"
                      style="cursor:pointer; font-size:18px; line-height:1; padding:0 2px;"
                      title="Lukk">Ã—</span>
            </div>
            <div style="padding:10px;">
                <p style="margin:3px 0; display:flex; align-items:center; gap:6px;">
                    <svg width="40" height="40" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" style="flex-shrink:0"><rect x="3" y="10" width="18" height="11" fill="#888"/><polygon points="2,10 12,2 22,10" fill="#666"/><rect x="9" y="15" width="6" height="6" fill="white"/></svg>
                    Ungdomsskole
                </p>
                <p style="margin:3px 0; display:flex; align-items:center; gap:6px;">
                    <svg width="30" height="30" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" style="flex-shrink:0; margin-left:5px;"><rect x="3" y="10" width="18" height="11" fill="#888"/><polygon points="2,10 12,2 22,10" fill="#666"/><rect x="9" y="15" width="6" height="6" fill="white"/></svg>
                    Barneskole
                </p>
                <hr style="margin:8px 0; border:none; border-top:1px solid #ccc;">
                <button onclick="document.getElementById('infoModal').style.display='block'"
                        title="Om fargefordelingen"
                        style="width:100%; padding:6px 0; background-color:#4285f4; color:white;
                               border:none; border-radius:4px; font-size:13px; cursor:pointer;
                               display:flex; align-items:center; justify-content:center; gap:6px;">
                    <span style="font-size:15px; font-weight:bold; width:20px; height:20px;
                                 border:2px solid white; border-radius:50%; display:inline-flex;
                                 align-items:center; justify-content:center; line-height:1;">i</span>
                    Om fargefordelingen
                </button>
                <button onclick="document.getElementById('skolekretsModal').style.display='block'"
                        title="Om skolekrets"
                        style="width:100%; margin-top:6px; padding:6px 0; background-color:#4285f4; color:white;
                               border:none; border-radius:4px; font-size:13px; cursor:pointer;
                               display:flex; align-items:center; justify-content:center; gap:6px;">
                    <span style="font-size:16px; line-height:1;">ğŸ—ºï¸</span>
                    Om skolekrets
                </button>
            </div>
        </div>

    </div><!-- /legendBox -->
</div><!-- /map-toolbar -->

<!-- Om Fargefordelingen Modal -->
<div id="infoModal" class="modal" onclick="if(event.target==this) this.style.display='none'">
    <div class="modal-content">
        <span class="close" onclick="document.getElementById('infoModal').style.display='none'">&times;</span>
        <h2>ğŸ“Š Om Fargefordelingen</h2>

        <h3>Offisiell Skala</h3>
        <p>Til nasjonale prÃ¸ver er det utviklet en egen skala (skalapoeng) hvor <strong>gjennomsnittet i 2022 ble satt til 50</strong> og <strong>standardavviket til 10</strong>. Alle prÃ¸veresultater blir omregnet til denne skalaen.</p>

        <div class="stats-box">
            <strong>Datagrunnlag (1 349 skoler):</strong><br>
            â€¢ Gjennomsnitt: 49,31 (nÃ¦r landsgjennomsnitt âœ“)<br>
            â€¢ Median: 49,33<br>
            â€¢ Standardavvik: 2,84<br>
            â€¢ Spredning: 39-59 poeng
        </div>

        <h3>Fargeforklaring</h3>
        <div class="color-explanation">
            <div class="color-row">
                <span class="color-dot" style="color: #d73027;">â¬¤</span>
                <div><strong>RÃ¸d (&lt; 45):</strong> Betydelig under landsgjennomsnitt (6,1% av skoler)</div>
            </div>
            <div class="color-row">
                <span class="color-dot" style="color: #fc8d59;">â¬¤</span>
                <div><strong>Oransje (45-49):</strong> Under landsgjennomsnitt (51,1% av skoler)</div>
            </div>
            <div class="color-row">
                <span class="color-dot" style="color: #91cf60;">â¬¤</span>
                <div><strong>LysegrÃ¸nn (50-54):</strong> Over landsgjennomsnitt (40,0% av skoler)</div>
            </div>
            <div class="color-row">
                <span class="color-dot" style="color: #1a9850;">â¬¤</span>
                <div><strong>MÃ¸rkegrÃ¸nn (â‰¥ 55):</strong> Betydelig over landsgjennomsnitt (2,7% av skoler)</div>
            </div>
            <div class="color-row">
                <span class="color-dot" style="color: #999999;">â¬¤</span>
                <div><strong>GrÃ¥:</strong> Ingen data tilgjengelig (alle fag mangler)</div>
            </div>
        </div>

        <h3>Begrunnelse</h3>
        <p>Fargefordelingen er basert pÃ¥ den offisielle nasjonale skalaen (50Â±10) for Ã¥ gi en:</p>
        <ul>
            <li><strong>Symmetrisk fordeling</strong> rundt landsgjennomsnittet (50)</li>
            <li><strong>Rettferdig vurdering</strong> som gjenspeiler den statistiske virkeligheten</li>
            <li><strong>Meningsfull tolkning</strong> basert pÃ¥ standardavvik</li>
        </ul>

        <p>Dette sikrer at skoler som presterer over det nasjonale gjennomsnittet fÃ¥r anerkjennelse, mens skoler som trenger stÃ¸tte blir identifisert.</p>

        <a href="https://statistikkportalen.udir.no/api/rapportering/rest/v1/Tekst/visTekst/19715?dataChanged=2026-02-19_074500#title5"
           target="_blank"
           class="official-link">
           ğŸ“– Les mer hos UDIR (offisiell forklaring)
        </a>
    </div>
</div>

<!-- Om Skolekrets Modal -->
<div id="skolekretsModal" class="modal" onclick="if(event.target==this) this.style.display='none'">
    <div class="modal-content">
        <span class="close" onclick="document.getElementById('skolekretsModal').style.display='none'">&times;</span>
        <h2>ğŸ—ºï¸ Om Skolekrets</h2>
        <p>En <strong>skolekrets</strong> er det geografiske omrÃ¥det som sogner til en bestemt skole. Hvilken skole barnet ditt tilhÃ¸rer, avhenger av hvilken adresse dere er folkeregistrert pÃ¥.</p>
        <p>Skolekretsinformasjon administreres av den enkelte kommune. Du finner din skolekrets pÃ¥ den offisielle nettsiden til kommunen skolen ligger i.</p>
        <h3>Oslo kommune</h3>
        <div class="color-explanation">
            <div class="color-row">
                <a href="https://www.oslo.kommune.no/skole-og-utdanning/skoleoversikt-og-skolekrets/skolekrets-barneskole/"
                   target="_blank" class="official-link" style="margin:0;">
                   ğŸ« Skolekrets â€“ barneskole
                </a>
            </div>
            <div class="color-row" style="margin-top:8px;">
                <a href="https://www.oslo.kommune.no/skole-og-utdanning/skoleoversikt-og-skolekrets/skolekrets-ungdomsskole/#toc-2"
                   target="_blank" class="official-link" style="margin:0;">
                   ğŸ« Skolekrets â€“ ungdomsskole
                </a>
            </div>
        </div>
        <p style="margin-top:16px; font-size:13px; color:#666;">For andre kommuner, sÃ¸k etter Â«skolekretsÂ» pÃ¥ kommunens egne nettsider.</p>
    </div>
</div>

